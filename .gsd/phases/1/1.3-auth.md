---
phase: 1
plan: 3
wave: 3
depends_on: [1, 2]
files_modified:
  - utils/supabase/server.ts
  - utils/supabase/client.ts
  - utils/supabase/middleware.ts
  - app/login/page.tsx
  - app/auth/callback/route.ts
  - app/(auth)/signup/page.tsx
autonomous: true
user_setup: []

must_haves:
  truths:
    - "User can sign up"
    - "User can log in"
    - "Session persists"
  artifacts:
    - "Supabase Auth Helpers created"
    - "Login Page created"
  key_links:
    - "Auth middleware protects routes"
---

# Plan 1.3: Auth Implementation

<objective>
Implement Supabase Authentication using SSR helpers. Create Login/Signup pages and Middleware for session management.

Purpose: specific instructions to enable user access.
Output: specific instructions to working auth flow.
</objective>

<context>
Load for context:
- .gsd/SPEC.md
- types/supabase.ts
</context>

<tasks>

<task type="auto">
  <name>Setup Auth Helpers (SSR)</name>
  <files>utils/supabase/server.ts, utils/supabase/client.ts, utils/supabase/middleware.ts</files>
  <action>
    Implement `createClient` for server (cookies), client (browser), and middleware (session refresh).
    Follow Supabase Next.js App Router guide exactly.
  </action>
  <verify>ls utils/supabase/</verify>
  <done>3 helper files created</done>
</task>

<task type="auto">
  <name>Create Auth Architecture</name>
  <files>app/auth/callback/route.ts, app/middleware.ts</files>
  <action>
    1. Create callback route to exchange code for session.
    2. Update root `middleware.ts` to use `updateSession`.
  </action>
  <verify>ls app/auth/callback/route.ts</verify>
  <done>Auth infrastructure ready</done>
</task>

<task type="auto">
  <name>Create Login/Signup Pages</name>
  <files>app/login/page.tsx, app/signup/page.tsx</files>
  <action>
    Create simple Shadcn forms for Login and Signup.
    Login Action: `signInWithPassword`.
    Signup Action: `signUp` (email/pass).
    Redirect to `/dashboard` on success.
  </action>
  <verify>ls app/login/page.tsx</verify>
  <done>UI for auth exists</done>
</task>

</tasks>

<verification>
After all tasks, verify:
- [ ] Build succeeds (`npm run build`)
- [ ] Auth helpers import correctly
</verification>
