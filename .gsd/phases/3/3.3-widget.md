---
phase: 3
plan: 3
wave: 2
depends_on: [2]
files_modified:
  - public/widget.js
  - app/dashboard/chatbots/[id]/page.tsx
  - components/deployment-code.tsx
autonomous: true
user_setup: []

must_haves:
  truths:
    - "widget.js creates IFrame pointing to /embed"
    - "Dashboard shows copy-paste code"
  artifacts:
    - "public/widget.js exists"
---

# Plan 3.3: Widget Deployment

<objective>
1. Create `public/widget.js`: The "loader" script users put on their site.
2. Update Dashboard: Show the installation code.

Purpose: specific instructions to distribution.
Output: specific instructions to working widget script.
</objective>

<context>
Load for context:
- .gsd/SPEC.md
</context>

<tasks>

<task type="auto">
  <name>Create Widget Script</name>
  <files>public/widget.js</files>
  <action>
    Vanilla JS script:
    - Reads `data-chatbot-id` from script tag.
    - Creates a fixed position button (Launcher).
    - Creates an IFrame pointing to `{HOST}/embed/{chatbotId}`.
    - Toggles visibility on click.
  </action>
  <verify>ls public/widget.js</verify>
  <done>Widget script created</done>
</task>

<task type="auto">
  <name>Add Deployment Tab</name>
  <files>app/dashboard/chatbots/[id]/page.tsx, components/deployment-code.tsx</files>
  <action>
    Add a 3rd tab to Chatbot Details: "Deployment".
    Show code snippet:
    `<script src="https://.../widget.js" data-chatbot-id="..."></script>`
  </action>
  <verify>ls components/deployment-code.tsx</verify>
  <done>Deployment instructions added</done>
</task>

</tasks>

<verification>
After all tasks, verify:
- [ ] Embed code is visible
- [ ] Script works on a test html page
</verification>
